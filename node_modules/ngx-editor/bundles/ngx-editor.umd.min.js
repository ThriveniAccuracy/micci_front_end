!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("prosemirror-state"),require("prosemirror-view"),require("prosemirror-commands"),require("prosemirror-model"),require("prosemirror-schema-basic"),require("prosemirror-schema-list"),require("prosemirror-utils")):"function"==typeof define&&define.amd?define("ngx-editor",["exports","@angular/core","@angular/forms","prosemirror-state","prosemirror-view","prosemirror-commands","prosemirror-model","prosemirror-schema-basic","prosemirror-schema-list","prosemirror-utils"],t):t((e=e||self)["ngx-editor"]={},e.ng.core,e.ng.forms,e.prosemirrorState,e.prosemirrorView,e.prosemirrorCommands,e.prosemirrorModel,e.prosemirrorSchemaBasic,e.prosemirrorSchemaList,e.prosemirrorUtils)}(this,(function(e,t,r,n,o,i,d,a,s,p){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function u(e,t,r,n){var o,i=arguments.length,d=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)d=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(d=(i<3?o(d):i>3?o(t,r,d):o(t,r))||d);return i>3&&d&&Object.defineProperty(t,r,d),d}var c=Object.assign({},s.listItem,{content:"paragraph block*"}),l=Object.assign({},s.orderedList,{content:"list_item+",group:"block"}),m=Object.assign({},s.bulletList,{content:"list_item+",group:"block"}),g=Object.assign({},a.nodes,{list_item:c,ordered_list:l,bullet_list:m}),h=new d.Schema({marks:a.marks,nodes:g}),f=function(e,t,r){void 0===r&&(r={});var n=e.selection,o=n.$from,i=n.to,d=p.findSelectedNodeOfType(t)(e.selection)||p.findParentNode((function(e){return e.type===t}))(e.selection);return Object.entries(r).length&&d?i<=o.end()&&o.parent.hasMarkup(t,r):!!d},v=function(e,t){var r=e.selection,n=r.from,o=r.$from,i=r.to;return r.empty?!!t.isInSet(e.storedMarks||o.marks()):e.doc.rangeHasMark(n,i,t)},x=function(e,t,r){return void 0===r&&(r={}),function(n,o){return f(n,e,r)?i.setBlockType(t)(n,o):i.setBlockType(e,r)(n,o)}},E=function(e,t){return function(r,n){return f(r,e)?s.liftListItem(t)(r,n):s.wrapInList(e)(r,n)}},_={bold:'\n  <path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z" />\n  <path d="M0 0h24v24H0z" fill="none" />\n',italic:'\n  <path d="M0 0h24v24H0z" fill="none" />\n  <path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z" />\n',code:'\n<path d="M0 0h24v24H0V0z" fill="none"/>\n<path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/>\n',ordered_list:'\n<path d="M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"/>\n<path d="M0 0h24v24H0z" fill="none"/>\n',bullet_list:'\n<path d="M0 0h24v24H0V0z" fill="none"/>\n<path d="M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"/>\n',arrow_drop_down:'\n<path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/>\n'};function M(e,t,r){return void 0===t&&(t=20),void 0===r&&(r=20),'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    viewBox="0 0 24 24"\n    fill="black"\n    height='+r+"\n    width="+t+"\n  >\n    "+(_[e]||"<path></path>")+"\n  </svg>\n  "}var w=function(e,t){return void 0===t&&(t=1),t>0?e.reduce((function(e,r){return e.concat(Array.isArray(r)?w(r,t-1):r)}),[]):e.slice()},N={bold:{key:"strong",i18nKey:"bold",icon:"bold",type:"mark"},italic:{key:"em",i18nKey:"italics",icon:"italic",type:"mark"},code:{key:"code",i18nKey:"code",icon:"code",type:"mark"},ordered_list:{key:"ordered_list",i18nKey:"ordered_list",icon:"ordered_list",type:"node"},bullet_list:{key:"bullet_list",i18nKey:"bullet_list",icon:"bullet_list",type:"node"},h1:{key:"heading",i18nKey:"heading",attrs:{level:1},type:"node"},h2:{key:"heading",i18nKey:"heading",attrs:{level:2},type:"node"},h3:{key:"heading",i18nKey:"heading",attrs:{level:3},type:"node"},h4:{key:"heading",i18nKey:"heading",attrs:{level:4},type:"node"},h5:{key:"heading",i18nKey:"heading",attrs:{level:5},type:"node"},h6:{key:"heading",i18nKey:"heading",attrs:{level:6},type:"node"}},y=new Map;y.set("heading",["h1","h2","h3","h4","h5","h6"]);var I=function(e){return e===h.nodes.list_item||e===h.nodes.ordered_list||e===h.nodes.bullet_list},b=function(){function e(e,t,r,n){this.updates=[],this.dropdownGroup=e,this.dropdownFields=t,this.editorView=r,this.options=n}return e.prototype.getWrapperDom=function(){var e=this,t=!1,r=document.createElement("div"),n=this.options.labels;r.classList.add("NgxEditor-MenuItem"),r.classList.add("NgxEditor-MenuItem__Dropdown-Wrapper");var o=document.createElement("div");o.classList.add("NgxEditor-MenuItem__Dropdown");var i=document.createElement("div");i.classList.add("NgxEditor-MenuItem__Dropdown-Text"),i.textContent=n[this.dropdownGroup];var d=document.createElement("div");d.classList.add("NgxEditor-MenuItem__Dropdown-Icon"),d.innerHTML=M("arrow_drop_down"),o.appendChild(i),o.appendChild(d);var a=function(e){e.preventDefault(),r.contains(e.target)||s()},s=function(){r.classList.remove("NgxEditor-MenuItem__Dropdown-Wrapper-Open"),t=!1,window.removeEventListener("mousedown",a)};o.addEventListener("click",(function(e){e.preventDefault(),t?s():(r.classList.add("NgxEditor-MenuItem__Dropdown-Wrapper-Open"),t=!0,window.addEventListener("mousedown",a))}));var p=document.createElement("div");return p.classList.add("NgxEditor-MenuItem__Dropdown-Menu"),this.dropdownFields.forEach((function(t){var o=N[t],d=n[o.key];"heading"===o.key&&(d+=" "+o.attrs.level);var a={classNames:["NgxEditor-MenuItem__Dropdown-Item"],textContent:d,attrs:{title:d}},u=new k(o,e.editorView,a).render(),c=u.update,l=u.dom;l.addEventListener("click",(function(e){e.preventDefault(),s()}));p.appendChild(l),e.updates.push((function(t){c(t);var o="NgxEditor-MenuItem__Dropdown-Wrapper-Selected",d=p.getElementsByClassName("NgxEditor-MenuItem__Active");if(d.length){var a=d[0];i.textContent=a.textContent,r.classList.add(o)}else i.textContent=n[e.dropdownGroup],r.classList.remove(o)}))})),r.appendChild(o),r.appendChild(p),r},e.prototype.render=function(){return this.dom=this.getWrapperDom(),{dom:this.dom,updates:this.updates}},e}(),k=function(){function e(e,t,r){this.menuItem=e,this.editorView=t,this.spec=r}return e.prototype.render=function(){var e=this,t=this.dom=this.getDom();this.setupCommandListeners();return{dom:t,update:function(r){var n=e.menuItem,o=!1;if("mark"===n.type){var i=h.marks[n.key];o=v(r,i)}if("node"===n.type){i=h.nodes[n.key];o=f(r,i,n.attrs)}t.classList.toggle("NgxEditor-MenuItem__Active",o)}}},e.prototype.getDom=function(){var e=document.createElement("div");return this.spec.classNames&&this.spec.classNames.forEach((function(t){e.classList.add(t)})),this.spec.attrs&&Object.entries(this.spec.attrs).forEach((function(t){e.setAttribute(t[0],t[1])})),this.spec.innerHTML&&(e.innerHTML=this.spec.innerHTML),this.spec.textContent&&(e.innerHTML=this.spec.textContent),e},e.prototype.setupCommandListeners=function(){var e=this;this.dom.addEventListener("mousedown",(function(t){if(t.preventDefault(),1===t.buttons)if("mark"!==e.menuItem.type){if("node"===e.menuItem.type){var r=h.nodes[e.menuItem.key];if(I(r))return void E(r,h.nodes.list_item)(e.editorView.state,e.editorView.dispatch);if(r===h.nodes.heading)return void x(r,h.nodes.paragraph,{level:e.menuItem.attrs.level})(e.editorView.state,e.editorView.dispatch)}}else i.toggleMark(h.marks[e.menuItem.key])(e.editorView.state,e.editorView.dispatch)}))},e}(),D=function(){var e=document.createElement("div");return e.className="NgxEditor-MenuItem__Seperator",e},L=function(){function e(e,t){this.view=e,this.options=t,this.render(),this.update()}return e.prototype.render=function(){var e=document.createElement("div");e.className="NgxEditor-MenuBar";var t=function(e,t,r){var n=[],o=e.toolbar;o.forEach((function(i,d){var a=o.length-1===d;i.forEach((function(o,d){var s=i.length-1===d;if("object"==typeof o&&Object.keys(o).forEach((function(i){if(y.has(i)){var d=o[i],a=new b(i,d,t,e).render();n.push(a.updates),r.appendChild(a.dom)}else console.warn("Unkown dropdown group:",i)})),"string"==typeof o){var p=N[o],u=e.labels;if(p){var c={classNames:["NgxEditor-MenuItem","NgxEditor-MenuItem__Icon","NgxEditor-MenuItem__"+p.key],innerHTML:M(p.icon),attrs:{title:u[p.i18nKey]}},l=new k(p,t,c).render(),m=l.update,g=l.dom;r.appendChild(g),n.push(m)}}if(s&&!a){var h=D();r.appendChild(h)}}))}));var i=w(n,1/0);return{update:function(e){i.forEach((function(t){t(e)}))}}}(this.options,this.view,e).update;this.updateMenuItems=t,this.view.dom.parentNode.insertBefore(e,this.view.dom)},e.prototype.update=function(){this.updateMenuItems(this.view.state)},e}(),C={toolbar:[["bold","italic"],["code"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}]],labels:{bold:"Bold",italics:"Italics",code:"Code",ordered_list:"Ordered List",bullet_list:"Bullet List",heading:"Heading"}};var H=function(e){return void 0===e&&(e=C),function(e){return new n.Plugin({key:new n.PluginKey("menu"),view:function(t){return new L(t,e)}})}(e)};function B(e){return void 0===e&&(e="Type Here..."),new n.Plugin({key:new n.PluginKey("placeholder"),props:{decorations:function(t){var r=t.doc;if(1===r.childCount&&r.firstChild.isTextblock&&0===r.firstChild.content.size){var n=document.createElement("span");return n.classList.add("NgxEditor-Placeholder"),n.textContent=e,o.DecorationSet.create(r,[o.Decoration.widget(1,n)])}return o.DecorationSet.empty}}})}var z=function(){function e(){this.plugins=[H(),B()]}return e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=u([t.Injectable({providedIn:"root"})],e)}(),O=function(){function e(e){this.config=e}var r,n;return e.ctorParameters=function(){return[{type:z,decorators:[{type:t.Optional}]}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(z,8))},token:e,providedIn:"root"}),e=u([t.Injectable({providedIn:"root"}),(r=0,n=t.Optional(),function(e,t){n(e,t,r)})],e)}();function W(e){return e}var V=function(){function e(e){this.config=e.config}var i;return i=e,e.prototype.writeValue=function(e){e&&this.updateContent(e)},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(){},e.prototype.parseDoc=function(e){return h.nodeFromJSON(e)},e.prototype.updateContent=function(e){try{var t=this.parseDoc(e),r=this.view.state,n=r.tr;n.replaceWith(0,r.doc.content.size,t),this.view.dispatch(n)}catch(e){console.error("Unable to update document.",e)}},e.prototype.handleTransactions=function(e){var t=this.view.state.applyTransaction(e).state;if(this.view.updateState(t),e.docChanged){var r=t.doc.toJSON();this.onChange(r)}},e.prototype.createEditor=function(){this.view=new o.EditorView(this.ngxEditor.nativeElement,{state:n.EditorState.create({schema:h,plugins:this.config.plugins}),dispatchTransaction:this.handleTransactions.bind(this),attributes:{class:"NgxEditor-Content"}})},e.prototype.ngOnInit=function(){this.createEditor()},e.prototype.ngOnDestroy=function(){this.view.destroy()},e.ctorParameters=function(){return[{type:O}]},u([t.ViewChild("ngxEditor",{static:!0})],e.prototype,"ngxEditor",void 0),e=i=u([t.Component({selector:"ngx-editor",template:'<div class="NgxEditor-Wrapper" #ngxEditor></div>\n',providers:[{provide:r.NG_VALUE_ACCESSOR,useExisting:t.forwardRef((function(){return i})),multi:!0}],encapsulation:t.ViewEncapsulation.None,styles:[".ProseMirror{outline:0}.NgxEditor-Wrapper{background:padding-box #fff;color:#000;border-radius:4px;border:2px solid rgba(0,0,0,.2)}.NgxEditor-MenuBar{display:flex;padding:.2rem;border-bottom:1px solid #ddd}.NgxEditor-MenuBar .NgxEditor-MenuItem{display:flex;align-items:center;justify-content:center}.NgxEditor-MenuBar .NgxEditor-MenuItem:hover{cursor:pointer;background-color:#f1f1f1}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Icon{height:30px;width:30px;transition:.3s ease-in-out;border-radius:2px;margin-right:2px}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Icon.NgxEditor-MenuItem__Active{background-color:#e8f0fe}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Icon.NgxEditor-MenuItem__Active svg{fill:#1a73e8}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper{position:relative;max-width:100px;width:100%;justify-content:start}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper .NgxEditor-MenuItem__Dropdown{display:flex;align-items:center;width:100%}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper .NgxEditor-MenuItem__Dropdown .NgxEditor-MenuItem__Dropdown-Text{margin-left:5px}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper .NgxEditor-MenuItem__Dropdown .NgxEditor-MenuItem__Dropdown-Icon{margin-left:auto;position:relative;top:2px}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper .NgxEditor-MenuItem__Dropdown-Menu{position:absolute;left:0;top:30px;box-shadow:rgba(60,64,67,.15) 0 2px 6px 2px;border-radius:4px;background-color:#fff;display:none}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper .NgxEditor-MenuItem__Dropdown-Menu .NgxEditor-MenuItem__Dropdown-Item{cursor:pointer;padding:.5rem 1rem;white-space:nowrap}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper .NgxEditor-MenuItem__Dropdown-Menu .NgxEditor-MenuItem__Dropdown-Item.NgxEditor-MenuItem__active,.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper .NgxEditor-MenuItem__Dropdown-Menu .NgxEditor-MenuItem__Dropdown-Item:hover{background-color:#f1f1f1}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper.NgxEditor-MenuItem__Dropdown-Wrapper-Open,.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper.NgxEditor-MenuItem__Dropdown-Wrapper-Selected{background-color:#e8f0fe;color:#1a73e8}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper.NgxEditor-MenuItem__Dropdown-Wrapper-Open .NgxEditor-MenuItem__Dropdown-Icon svg{fill:#1a73e8}.NgxEditor-MenuBar .NgxEditor-MenuItem.NgxEditor-MenuItem__Dropdown-Wrapper.NgxEditor-MenuItem__Dropdown-Wrapper-Open .NgxEditor-MenuItem__Dropdown-Menu{display:block;color:initial}.NgxEditor-MenuBar .NgxEditor-MenuItem__Seperator{border-left:1px solid #ccc;margin:0 5px}.NgxEditor-Content{padding:.5rem;white-space:pre-wrap}.NgxEditor-Content p{margin:0 0 .7rem}.NgxEditor-Placeholder{color:#6c757d;opacity:1}"]})],e)}(),j=new t.InjectionToken("NgxEditorConfig"),T=function(){function e(){}var r;return r=e,e.forRoot=function(e){return{ngModule:r,providers:[{provide:j,useValue:e},{provide:z,useFactory:W,deps:[j]}]}},e=r=u([t.NgModule({declarations:[V],exports:[V]})],e)}();e.NgxEditorComponent=V,e.NgxEditorModule=T,e.isMarkActive=v,e.isNodeActive=f,e.menu=H,e.placeholder=B,e.schema=h,e.toggleBlockType=x,e.toggleList=E,e.ɵa=z,e.ɵb=O,e.ɵc=W,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-editor.umd.min.js.map